# Contracts

#### 介绍

以太坊上调用次数超过8000次的热门智能合约源代码，共计9236个合约

其中1906个合约(20.64%)没有公开源码，对Top100的合约通过反编译的方式获取源码(使用[Online Solidity Decompiler](https://ethervm.io/decompile)编译为Solidity，使用[Panoramix decompiler](https://etherscan.io/bytecode-decompiler)编译为Vyper，当字节码过长时会失败)，其中，编号21、36的合约反编译失败，编号55、70的合约反编译为`Vyper`语言，目前剩余1883个合约无源代码，文件为空。


合约源码位于`contracts`目录下，部分合约使用Vyper语言编写，命名规则为`"调用次数排名(降序)-调用次数-合约地址.sol/.vy"`

Vyper语言编写的合约共计86个，编号如下：
```
55 70 121 806 828 833 868 962 
1020 1031 1036 1152 1418 1447 1526 1670 1719 1827
2069 2144 2184 2250 2472 2754 
3085 3090 3197 3229 3252 3684 3766 3793 3964 3967 3986 
4346 4366 4367 4397 4445 4698 4707 4774 4811 4979 
5095 5111 5131 5206 5219 5382 5544 5854 5863 5926 5995 
6007 6095 6258 6559 6602 6611 6823 6872 6887 6928 6996 
7044 7239 7311 7318 7511 7789 7803 
8212 8260 8275 8321 8418 8458 8610 8649 8852 8863 
9103 9191
```

目前根据代码相似度对top1000的合约进行了分类(无源码合约舍弃)，共分为431组，分类结果在`groups/`下

目录下文件命名方式为`不相似度(与该组编号最小的合约)_调用次数排名(降序)-调用次数-合约地址.sol/.vy`

对合约分析的标注结果见`group_info.xlsx`

#### 分析结果

1. 对TOP100合约的分类和功能描述情况详见`contract_info.xlsx`

数量及分类如下：

```
Token: 45个，代币合约，包括ERC20和非ERC20代币
DEX: 19个，去中心化交易所
MEV Bot: 8个，套利机器人，地址多以0x000000...开头，可能为了减少gas费用
NFTM: 3个， OpenSea NFT交易市场
ICO: 3个，众筹合约，均疑似庞氏骗局
GAME: 2个，EasyClub金融游戏，Dice2Win博彩游戏
Bridge: 2个，侧链桥
NFT: 1个，CryptoKitties
其他类型单独标注 包括Proxy, Registrar等
```

Top1合约调用次数占比13.99%
	
Top10合约调用次数占比累计37.49%，第9个合约起，每个合约调用次数占比＜1%
	
Top100合约调用次数占比累计57.67%
	
Top637合约调用次数占比累计75.73%，第638个合约起，每个合约的调用次数占比≤0.01%

2. TOP1000分析
	
主要合约类型及数量：

| 类型 | 组数量 | 合约数量 |
| :-: | :-: | :-: |
|Token|268|725|
|DEX|46|62|
|Proxy|11|24|
|Oracle|3|18|
|GAME|10|13|
|DeFi|10|10|
|Bridge|6|8|
|ICO|6|7|
|MEV Bot|6|6|
|NFT|5|6|
|NFTM|4|5|
|Registrar|4|4|
|Stake|3|4|
|Auction|3|3|
|Library|3|3|
|ReentrancyGuard|1|1|
|...|...|...|

分组结果较为准确，一些短合约（几行，一行编译器版本，一行contract*{）分组结果有些偏差，组内合约相似性不大，但这部分数量很少。
	
大量的Token合约格式： 引入库和标准合约`SafeMath, Ownable, ERC20Basic`，基于此建立子类`ERC20, BasicToken, StandardToken,  UpgradedStandardToken`，最后继承出自己的代币`XXXToken`，多组代币合约间存在相似性。

----

合约获取时间截止到2022年7月27日，合约获取、分析过程及详细数据见https://github.com/JolyonJian/tx-analysis

